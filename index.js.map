{"version":3,"file":"index.js","sources":["src/index.js"],"sourcesContent":["import { createElement, Component, Children } from 'react'\n\nconst CONTEXT_TYPES = {\n  store: () => {}\n}\n\nexport class Provider extends Component {\n  getChildContext() {\n    return { store: this.props.store }\n  }\n\n  render() {\n    return Children.only(this.props.children)\n  }\n}\n\nProvider.childContextTypes = CONTEXT_TYPES\n\nexport const connect = (...args) => {\n  const Comp = args.slice(-1)[0]\n  const strings = args.length > 1 ? args.slice(0, -1) : []\n  const actionCreators = []\n  const keysToWatch = []\n  strings.forEach(str => {\n    if (str.slice(0, 6) === 'select') {\n      keysToWatch.push(str)\n      return\n    }\n    if (str.slice(0, 2) === 'do') {\n      actionCreators.push(str)\n      return\n    }\n    throw Error(`CanNotConnect ${str}`)\n  })\n\n  class Connect extends Component {\n    constructor(props, context) {\n      super(props, context)\n      const store = context.store\n      this.state = store.select(keysToWatch)\n      this.unsubscribe = store.subscribeToSelectors(\n        keysToWatch,\n        this.setState.bind(this)\n      )\n      this.actionCreators = {}\n      actionCreators.forEach(name => {\n        this.actionCreators[name] = (...args) => {\n          if (store.action) {\n            return store.action(name, args)\n          }\n          return store[name](...args)\n        }\n      })\n    }\n\n    componentWillUnmount() {\n      this.unsubscribe()\n    }\n\n    render() {\n      return createElement(\n        Comp,\n        Object.assign({}, this.props, this.state, this.actionCreators)\n      )\n    }\n  }\n  Connect.contextTypes = CONTEXT_TYPES\n  Connect.displayName = 'connect(' + (Comp.displayName || Comp.name) + ')'\n  return Connect\n}\n"],"names":["const","CONTEXT_TYPES","store","Provider","getChildContext","props","render","Children","only","children","Component","childContextTypes","connect","Comp","args","slice","strings","length","actionCreators","keysToWatch","forEach","str","push","Error","Connect","constructor","context","state","select","unsubscribe","subscribeToSelectors","setState","bind","name","action","componentWillUnmount","createElement","Object","assign","contextTypes","displayName"],"mappings":";;AAEAA,IAAMC,aAAa,GAAG;EACpBC,KAAK,cAAQ;CADf;AAIA,IAAaC,QAAN;;;;;;;;;qBACLC,8CAAkB;WACT;MAAEF,KAAK,EAAE,KAAKG,KAAL,CAAWH;KAA3B;;;qBAGFI,4BAAS;WACAC,cAAQ,CAACC,IAAT,CAAc,KAAKH,KAAL,CAAWI,QAAzB,CAAP;;;;EAN0BC;AAU9BP,QAAQ,CAACQ,iBAAT,GAA6BV,aAA7B;AAEA,IAAaW,OAAO;;;;MACZC,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAW,CAAC,CAAZ,EAAe,CAAf,CAAb;MACMC,OAAO,GAAGF,IAAI,CAACG,MAAL,GAAc,CAAd,GAAkBH,IAAI,CAACC,KAAL,CAAW,CAAX,EAAc,CAAC,CAAf,CAAlB,GAAsC,EAAtD;MACMG,cAAc,GAAG,EAAvB;MACMC,WAAW,GAAG,EAApB;EACAH,OAAO,CAACI,OAAR,WAAgBC;QACVA,GAAG,CAACN,KAAJ,CAAU,CAAV,EAAa,CAAb,MAAoB,QAAxB,EAAkC;MAChCI,WAAW,CAACG,IAAZ,CAAiBD,GAAjB;;;;QAGEA,GAAG,CAACN,KAAJ,CAAU,CAAV,EAAa,CAAb,MAAoB,IAAxB,EAA8B;MAC5BG,cAAc,CAACI,IAAf,CAAoBD,GAApB;;;;UAGIE,KAAK,qBAAkBF,GAAI,EAAjC;GATF;;MAYMG,OAAN;IACEC,gBAAW,CAACpB,KAAD,EAAQqB,OAAR,EAAiB;;;2BACpBrB,KAAN,EAAaqB,OAAb;UACMxB,KAAK,GAAGwB,OAAO,CAACxB,KAAtB;WACKyB,KAAL,GAAazB,KAAK,CAAC0B,MAAN,CAAaT,WAAb,CAAb;WACKU,WAAL,GAAmB3B,KAAK,CAAC4B,oBAAN,CACjBX,WADiB,EAEjB,KAAKY,QAAL,CAAcC,IAAd,CAAmB,IAAnB,CAFiB,CAAnB;WAIKd,cAAL,GAAsB,EAAtB;MACAA,cAAc,CAACE,OAAf,WAAuBa;eAChBf,cAAL,CAAoBe,IAApB;;;;cACM/B,KAAK,CAACgC,MAAV,EAAkB;mBACThC,KAAK,CAACgC,MAAN,CAAaD,IAAb,EAAmBnB,IAAnB,CAAP;;;iBAEKZ,KAAK,CAAC+B,IAAD,OAAL,CAAY,OAAGnB,IAAf,CAAP;SAJF;OADF;;;;;;;sBAUFqB,wDAAuB;WAChBN,WAAL;;;sBAGFvB,4BAAS;aACA8B,mBAAa,CAClBvB,IADkB,EAElBwB,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkB,KAAKjC,KAAvB,EAA8B,KAAKsB,KAAnC,EAA0C,KAAKT,cAA/C,CAFkB,CAApB;;;;IAzBkBR;;EA+BtBc,OAAO,CAACe,YAAR,GAAuBtC,aAAvB;EACAuB,OAAO,CAACgB,WAAR,GAAsB,cAAc3B,IAAI,CAAC2B,WAAL,IAAoB3B,IAAI,CAACoB,IAAvC,IAA+C,GAArE;SACOT,OAAP;CAlDK;;;;;"}